<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - master-ibm-intel-check - opal/class/opal_graph.c</title>
  <link rel="stylesheet" type="text/css" href="../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../index.html">top level</a> - <a href="index.html">opal/class</a> - opal_graph.c<span style="font-size: 80%;"> (source / <a href="opal_graph.c.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">master-ibm-intel-check</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">290</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2015-07-31 16:35:34</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">24</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr><td><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /*</a>
<span class="lineNum">       2 </span>            :  * Copyright (c) 2004-2005 The Trustees of Indiana University and Indiana
<span class="lineNum">       3 </span>            :  *                         University Research and Technology
<span class="lineNum">       4 </span>            :  *                         Corporation.  All rights reserved.
<span class="lineNum">       5 </span>            :  * Copyright (c) 2004-2012 The University of Tennessee and The University
<span class="lineNum">       6 </span>            :  *                         of Tennessee Research Foundation.  All rights
<span class="lineNum">       7 </span>            :  *                         reserved.
<span class="lineNum">       8 </span>            :  * Copyright (c) 2004-2007 High Performance Computing Center Stuttgart,
<span class="lineNum">       9 </span>            :  *                         University of Stuttgart.  All rights reserved.
<span class="lineNum">      10 </span>            :  * Copyright (c) 2004-2005 The Regents of the University of California.
<span class="lineNum">      11 </span>            :  *                         All rights reserved.
<span class="lineNum">      12 </span>            :  * Copyright (c) 2007      Voltaire All rights reserved.
<span class="lineNum">      13 </span>            :  * $COPYRIGHT$
<span class="lineNum">      14 </span>            :  *
<span class="lineNum">      15 </span>            :  * Additional copyrights may follow
<span class="lineNum">      16 </span>            :  *
<span class="lineNum">      17 </span>            :  * $HEADER$
<span class="lineNum">      18 </span>            :  */
<span class="lineNum">      19 </span>            : 
<span class="lineNum">      20 </span>            : #include &quot;opal_config.h&quot;
<span class="lineNum">      21 </span>            : 
<span class="lineNum">      22 </span>            : #include &quot;opal/class/opal_list.h&quot;
<span class="lineNum">      23 </span>            : #include &quot;opal/constants.h&quot;
<span class="lineNum">      24 </span>            : #include &quot;opal/class/opal_graph.h&quot;
<span class="lineNum">      25 </span>            : #include &quot;opal/util/output.h&quot;
<span class="lineNum">      26 </span>            : 
<span class="lineNum">      27 </span>            : static int compare_vertex_distance(const void *item1, const void *item2);
<span class="lineNum">      28 </span>            : 
<span class="lineNum">      29 </span>            : /*
<span class="lineNum">      30 </span>            :  *  Graph classes
<span class="lineNum">      31 </span>            :  */
<span class="lineNum">      32 </span>            : 
<span class="lineNum">      33 </span>            : 
<span class="lineNum">      34 </span>            : static void opal_graph_vertex_construct(opal_graph_vertex_t *vertex);
<span class="lineNum">      35 </span>            : static void opal_graph_vertex_destruct(opal_graph_vertex_t *vertex);
<span class="lineNum">      36 </span>            : 
<span class="lineNum">      37 </span>            : OBJ_CLASS_INSTANCE(
<span class="lineNum">      38 </span>            :     opal_graph_vertex_t,
<span class="lineNum">      39 </span>            :     opal_list_item_t,
<span class="lineNum">      40 </span>            :     opal_graph_vertex_construct,
<span class="lineNum">      41 </span>            :     opal_graph_vertex_destruct
<span class="lineNum">      42 </span>            : );
<span class="lineNum">      43 </span>            : 
<span class="lineNum">      44 </span>            : 
<span class="lineNum">      45 </span>            : static void opal_graph_edge_construct(opal_graph_edge_t *edge);
<span class="lineNum">      46 </span>            : static void opal_graph_edge_destruct(opal_graph_edge_t *edge);
<span class="lineNum">      47 </span>            : 
<span class="lineNum">      48 </span>            : OBJ_CLASS_INSTANCE(
<span class="lineNum">      49 </span>            :     opal_graph_edge_t,
<span class="lineNum">      50 </span>            :     opal_list_item_t,
<span class="lineNum">      51 </span>            :     opal_graph_edge_construct,
<span class="lineNum">      52 </span>            :     opal_graph_edge_destruct
<span class="lineNum">      53 </span>            : );
<span class="lineNum">      54 </span>            : 
<span class="lineNum">      55 </span>            : static void opal_graph_construct(opal_graph_t *graph);
<span class="lineNum">      56 </span>            : static void opal_graph_destruct(opal_graph_t *graph);
<span class="lineNum">      57 </span>            : 
<span class="lineNum">      58 </span>            : OBJ_CLASS_INSTANCE(
<span class="lineNum">      59 </span>            :     opal_graph_t,
<span class="lineNum">      60 </span>            :     opal_object_t,
<span class="lineNum">      61 </span>            :     opal_graph_construct,
<span class="lineNum">      62 </span>            :     opal_graph_destruct
<span class="lineNum">      63 </span>            : );
<span class="lineNum">      64 </span>            : 
<span class="lineNum">      65 </span>            : static void opal_adjacency_list_construct(opal_adjacency_list_t *aj_list);
<span class="lineNum">      66 </span>            : static void opal_adjacency_list_destruct(opal_adjacency_list_t *aj_list);
<span class="lineNum">      67 </span>            : 
<span class="lineNum">      68 </span>            : OBJ_CLASS_INSTANCE(
<span class="lineNum">      69 </span>            :     opal_adjacency_list_t,
<span class="lineNum">      70 </span>            :     opal_list_item_t,
<span class="lineNum">      71 </span>            :     opal_adjacency_list_construct,
<span class="lineNum">      72 </span>            :     opal_adjacency_list_destruct
<span class="lineNum">      73 </span>            : );
<span class="lineNum">      74 </span>            : 
<span class="lineNum">      75 </span>            : 
<span class="lineNum">      76 </span>            : 
<span class="lineNum">      77 </span>            : /*
<span class="lineNum">      78 </span>            :  *
<span class="lineNum">      79 </span>            :  *      opal_graph_vertex_t interface
<span class="lineNum">      80 </span>            :  *
<a name="81"><span class="lineNum">      81 </span>            :  */</a>
<span class="lineNum">      82 </span>            : 
<span class="lineNum">      83 </span><span class="lineNoCov">          0 : static void opal_graph_vertex_construct(opal_graph_vertex_t *vertex)</span>
<span class="lineNum">      84 </span>            : {
<span class="lineNum">      85 </span><span class="lineNoCov">          0 :     vertex-&gt;in_adj_list = NULL;</span>
<span class="lineNum">      86 </span><span class="lineNoCov">          0 :     vertex-&gt;in_graph = NULL;</span>
<span class="lineNum">      87 </span><span class="lineNoCov">          0 :     vertex-&gt;vertex_data = NULL;</span>
<span class="lineNum">      88 </span><span class="lineNoCov">          0 :     vertex-&gt;sibling = NULL;</span>
<span class="lineNum">      89 </span><span class="lineNoCov">          0 :     vertex-&gt;copy_vertex_data = NULL;</span>
<span class="lineNum">      90 </span><span class="lineNoCov">          0 :     vertex-&gt;free_vertex_data = NULL;</span>
<span class="lineNum">      91 </span><span class="lineNoCov">          0 :     vertex-&gt;alloc_vertex_data = NULL;</span>
<span class="lineNum">      92 </span><span class="lineNoCov">          0 :     vertex-&gt;compare_vertex = NULL;</span>
<span class="lineNum">      93 </span><span class="lineNoCov">          0 :     vertex-&gt;print_vertex = NULL;</span>
<a name="94"><span class="lineNum">      94 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">      95 </span>            : 
<span class="lineNum">      96 </span><span class="lineNoCov">          0 : static void opal_graph_vertex_destruct(opal_graph_vertex_t *vertex)</span>
<span class="lineNum">      97 </span>            : {
<span class="lineNum">      98 </span><span class="lineNoCov">          0 :     vertex-&gt;in_adj_list = NULL;</span>
<span class="lineNum">      99 </span><span class="lineNoCov">          0 :     vertex-&gt;in_graph = NULL;</span>
<span class="lineNum">     100 </span><span class="lineNoCov">          0 :     vertex-&gt;sibling = NULL;</span>
<span class="lineNum">     101 </span><span class="lineNoCov">          0 :     vertex-&gt;copy_vertex_data = NULL;</span>
<span class="lineNum">     102 </span><span class="lineNoCov">          0 :     vertex-&gt;alloc_vertex_data = NULL;</span>
<span class="lineNum">     103 </span><span class="lineNoCov">          0 :     vertex-&gt;compare_vertex = NULL;</span>
<span class="lineNum">     104 </span><span class="lineNoCov">          0 :     if (NULL != vertex-&gt;free_vertex_data) {</span>
<span class="lineNum">     105 </span><span class="lineNoCov">          0 :         vertex-&gt;free_vertex_data(vertex-&gt;vertex_data);</span>
<span class="lineNum">     106 </span>            :     }
<span class="lineNum">     107 </span><span class="lineNoCov">          0 :     vertex-&gt;vertex_data = NULL;</span>
<span class="lineNum">     108 </span><span class="lineNoCov">          0 :     vertex-&gt;print_vertex = NULL;</span>
<span class="lineNum">     109 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     110 </span>            : 
<span class="lineNum">     111 </span>            : 
<span class="lineNum">     112 </span>            : /*
<span class="lineNum">     113 </span>            :  *
<span class="lineNum">     114 </span>            :  *      opal_graph_edge_t interface
<span class="lineNum">     115 </span>            :  *
<a name="116"><span class="lineNum">     116 </span>            :  */</a>
<span class="lineNum">     117 </span>            : 
<span class="lineNum">     118 </span><span class="lineNoCov">          0 : static void opal_graph_edge_construct(opal_graph_edge_t *edge)</span>
<span class="lineNum">     119 </span>            : {
<span class="lineNum">     120 </span><span class="lineNoCov">          0 :     edge-&gt;end = NULL;</span>
<span class="lineNum">     121 </span><span class="lineNoCov">          0 :     edge-&gt;start = NULL;</span>
<span class="lineNum">     122 </span><span class="lineNoCov">          0 :     edge-&gt;weight = 0;</span>
<span class="lineNum">     123 </span><span class="lineNoCov">          0 :     edge-&gt;in_adj_list = NULL;</span>
<span class="lineNum">     124 </span><span class="lineNoCov">          0 : }</span>
<a name="125"><span class="lineNum">     125 </span>            : </a>
<span class="lineNum">     126 </span>            : 
<span class="lineNum">     127 </span><span class="lineNoCov">          0 : static void opal_graph_edge_destruct(opal_graph_edge_t *edge)</span>
<span class="lineNum">     128 </span>            : {
<span class="lineNum">     129 </span><span class="lineNoCov">          0 :     edge-&gt;end = NULL;</span>
<span class="lineNum">     130 </span><span class="lineNoCov">          0 :     edge-&gt;start = NULL;</span>
<span class="lineNum">     131 </span><span class="lineNoCov">          0 :     edge-&gt;weight = 0;</span>
<span class="lineNum">     132 </span><span class="lineNoCov">          0 :     edge-&gt;in_adj_list = NULL;</span>
<span class="lineNum">     133 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     134 </span>            : 
<span class="lineNum">     135 </span>            : 
<span class="lineNum">     136 </span>            : /*
<span class="lineNum">     137 </span>            :  *
<span class="lineNum">     138 </span>            :  *     opal_graph_t  interface
<span class="lineNum">     139 </span>            :  *
<span class="lineNum">     140 </span>            :  */
<a name="141"><span class="lineNum">     141 </span>            : </a>
<span class="lineNum">     142 </span>            : 
<span class="lineNum">     143 </span><span class="lineNoCov">          0 : static void opal_graph_construct(opal_graph_t *graph)</span>
<span class="lineNum">     144 </span>            : {
<span class="lineNum">     145 </span><span class="lineNoCov">          0 :     graph-&gt;adjacency_list = OBJ_NEW(opal_list_t);</span>
<span class="lineNum">     146 </span><span class="lineNoCov">          0 :     graph-&gt;number_of_vertices = 0;</span>
<span class="lineNum">     147 </span><span class="lineNoCov">          0 :     graph-&gt;number_of_edges = 0;</span>
<a name="148"><span class="lineNum">     148 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     149 </span>            : 
<span class="lineNum">     150 </span><span class="lineNoCov">          0 : static void opal_graph_destruct(opal_graph_t *graph)</span>
<span class="lineNum">     151 </span>            : {
<span class="lineNum">     152 </span>            :     opal_adjacency_list_t *aj_list;
<span class="lineNum">     153 </span>            : 
<span class="lineNum">     154 </span><span class="lineNoCov">          0 :     while (false == opal_list_is_empty(graph-&gt;adjacency_list)) {</span>
<span class="lineNum">     155 </span><span class="lineNoCov">          0 :         aj_list = (opal_adjacency_list_t *)opal_list_remove_first(graph-&gt;adjacency_list);</span>
<span class="lineNum">     156 </span><span class="lineNoCov">          0 :         OBJ_RELEASE(aj_list);</span>
<span class="lineNum">     157 </span>            :     }
<span class="lineNum">     158 </span><span class="lineNoCov">          0 :     OBJ_RELEASE(graph-&gt;adjacency_list);</span>
<span class="lineNum">     159 </span><span class="lineNoCov">          0 :     graph-&gt;number_of_vertices = 0;</span>
<span class="lineNum">     160 </span><span class="lineNoCov">          0 :     graph-&gt;number_of_edges = 0;</span>
<span class="lineNum">     161 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     162 </span>            : 
<span class="lineNum">     163 </span>            : /*
<span class="lineNum">     164 </span>            :  *
<span class="lineNum">     165 </span>            :  *     opal_adjacency_list  interface
<span class="lineNum">     166 </span>            :  *
<a name="167"><span class="lineNum">     167 </span>            :  */</a>
<span class="lineNum">     168 </span>            : 
<span class="lineNum">     169 </span><span class="lineNoCov">          0 : static void opal_adjacency_list_construct(opal_adjacency_list_t *aj_list)</span>
<span class="lineNum">     170 </span>            : {
<span class="lineNum">     171 </span><span class="lineNoCov">          0 :     aj_list-&gt;vertex = NULL;</span>
<span class="lineNum">     172 </span><span class="lineNoCov">          0 :     aj_list-&gt;edges = OBJ_NEW(opal_list_t);</span>
<a name="173"><span class="lineNum">     173 </span><span class="lineNoCov">          0 : }</span></a>
<span class="lineNum">     174 </span>            : 
<span class="lineNum">     175 </span><span class="lineNoCov">          0 : static void opal_adjacency_list_destruct(opal_adjacency_list_t *aj_list)</span>
<span class="lineNum">     176 </span>            : {
<span class="lineNum">     177 </span>            :    opal_graph_edge_t *edge;
<span class="lineNum">     178 </span>            : 
<span class="lineNum">     179 </span><span class="lineNoCov">          0 :    aj_list-&gt;vertex = NULL;</span>
<span class="lineNum">     180 </span><span class="lineNoCov">          0 :    while (false == opal_list_is_empty(aj_list-&gt;edges)) {</span>
<span class="lineNum">     181 </span><span class="lineNoCov">          0 :        edge = (opal_graph_edge_t *)opal_list_remove_first(aj_list-&gt;edges);</span>
<span class="lineNum">     182 </span><span class="lineNoCov">          0 :        OBJ_RELEASE(edge);</span>
<span class="lineNum">     183 </span>            :    }
<span class="lineNum">     184 </span><span class="lineNoCov">          0 :    OBJ_RELEASE(aj_list-&gt;edges);</span>
<span class="lineNum">     185 </span>            : 
<span class="lineNum">     186 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     187 </span>            : 
<span class="lineNum">     188 </span>            : /**
<span class="lineNum">     189 </span>            :  * This function deletes all the edges that are connected *to* a
<span class="lineNum">     190 </span>            :  * vertex.
<span class="lineNum">     191 </span>            :  *
<span class="lineNum">     192 </span>            :  * @param graph
<a name="193"><span class="lineNum">     193 </span>            :  * @param vertex</a>
<span class="lineNum">     194 </span>            :  */
<span class="lineNum">     195 </span><span class="lineNoCov">          0 : static void delete_all_edges_conceded_to_vertex(opal_graph_t *graph, opal_graph_vertex_t *vertex)</span>
<span class="lineNum">     196 </span>            : {
<span class="lineNum">     197 </span>            :     opal_adjacency_list_t *aj_list;
<span class="lineNum">     198 </span>            :     opal_list_item_t *aj_list_item;
<span class="lineNum">     199 </span>            :     opal_graph_edge_t *edge;
<span class="lineNum">     200 </span>            :     opal_list_item_t *edge_item;
<span class="lineNum">     201 </span>            : 
<span class="lineNum">     202 </span>            :     /**
<span class="lineNum">     203 </span>            :      * for all the adjacency list in the graph
<span class="lineNum">     204 </span>            :      */
<span class="lineNum">     205 </span><span class="lineNoCov">          0 :     for (aj_list_item = opal_list_get_first(graph-&gt;adjacency_list);</span>
<span class="lineNum">     206 </span><span class="lineNoCov">          0 :          aj_list_item != opal_list_get_end(graph-&gt;adjacency_list);</span>
<span class="lineNum">     207 </span><span class="lineNoCov">          0 :          aj_list_item  = opal_list_get_next(aj_list_item)) {</span>
<span class="lineNum">     208 </span><span class="lineNoCov">          0 :         aj_list = (opal_adjacency_list_t *) aj_list_item;</span>
<span class="lineNum">     209 </span>            :         /**
<span class="lineNum">     210 </span>            :          * for all the edges in the adjacency list
<span class="lineNum">     211 </span>            :          */
<span class="lineNum">     212 </span><span class="lineNoCov">          0 :         edge_item = opal_list_get_first(aj_list-&gt;edges);</span>
<span class="lineNum">     213 </span><span class="lineNoCov">          0 :         while (edge_item != opal_list_get_end(aj_list-&gt;edges)) {</span>
<span class="lineNum">     214 </span><span class="lineNoCov">          0 :             edge = (opal_graph_edge_t *)edge_item;</span>
<span class="lineNum">     215 </span><span class="lineNoCov">          0 :             edge_item  = opal_list_get_next(edge_item);</span>
<span class="lineNum">     216 </span>            : 
<span class="lineNum">     217 </span>            :             /**
<span class="lineNum">     218 </span>            :              * if the edge is ended in the vertex
<span class="lineNum">     219 </span>            :              */
<span class="lineNum">     220 </span><span class="lineNoCov">          0 :             if (edge-&gt;end == vertex) {</span>
<span class="lineNum">     221 </span>            :                 /* Delete this edge  */
<span class="lineNum">     222 </span><span class="lineNoCov">          0 :                 opal_list_remove_item(edge-&gt;in_adj_list-&gt;edges, (opal_list_item_t*)edge);</span>
<span class="lineNum">     223 </span>            :                 /* distract this edge */
<span class="lineNum">     224 </span><span class="lineNoCov">          0 :                 OBJ_RELEASE(edge);</span>
<span class="lineNum">     225 </span>            :             }
<span class="lineNum">     226 </span>            :         }
<span class="lineNum">     227 </span>            :     }
<span class="lineNum">     228 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     229 </span>            : 
<span class="lineNum">     230 </span>            : /**
<span class="lineNum">     231 </span>            :  * This graph API adds a vertex to graph. The most common use
<span class="lineNum">     232 </span>            :  * for this API is while building a graph.
<span class="lineNum">     233 </span>            :  *
<span class="lineNum">     234 </span>            :  * @param graph The graph that the vertex will be added to.
<a name="235"><span class="lineNum">     235 </span>            :  * @param vertex The vertex we want to add.</a>
<span class="lineNum">     236 </span>            :  */
<span class="lineNum">     237 </span><span class="lineNoCov">          0 : void opal_graph_add_vertex(opal_graph_t *graph, opal_graph_vertex_t *vertex)</span>
<span class="lineNum">     238 </span>            : {
<span class="lineNum">     239 </span>            :    opal_adjacency_list_t *aj_list;
<span class="lineNum">     240 </span>            :    opal_list_item_t *item;
<span class="lineNum">     241 </span>            : 
<span class="lineNum">     242 </span>            :    /**
<span class="lineNum">     243 </span>            :     * Find if this vertex already exists in the graph.
<span class="lineNum">     244 </span>            :     */
<span class="lineNum">     245 </span><span class="lineNoCov">          0 :    for (item = opal_list_get_first(graph-&gt;adjacency_list);</span>
<span class="lineNum">     246 </span><span class="lineNoCov">          0 :         item != opal_list_get_end(graph-&gt;adjacency_list);</span>
<span class="lineNum">     247 </span><span class="lineNoCov">          0 :         item  = opal_list_get_next(item)) {</span>
<span class="lineNum">     248 </span><span class="lineNoCov">          0 :        aj_list = (opal_adjacency_list_t *) item;</span>
<span class="lineNum">     249 </span><span class="lineNoCov">          0 :        if (aj_list-&gt;vertex == vertex) {</span>
<span class="lineNum">     250 </span>            :            /* If this vertex exists, dont do anything. */
<span class="lineNum">     251 </span><span class="lineNoCov">          0 :            return;</span>
<span class="lineNum">     252 </span>            :        }
<span class="lineNum">     253 </span>            :    }
<span class="lineNum">     254 </span>            :    /* Construct a new adjacency list */
<span class="lineNum">     255 </span><span class="lineNoCov">          0 :    aj_list = OBJ_NEW(opal_adjacency_list_t);</span>
<span class="lineNum">     256 </span><span class="lineNoCov">          0 :    aj_list-&gt;vertex = vertex;</span>
<span class="lineNum">     257 </span>            :    /* point the vertex to the adjacency list of the vertex (for easy searching) */
<span class="lineNum">     258 </span><span class="lineNoCov">          0 :    vertex-&gt;in_adj_list = aj_list;</span>
<span class="lineNum">     259 </span>            :    /* Append the new creates adjacency list to the graph */
<span class="lineNum">     260 </span><span class="lineNoCov">          0 :    opal_list_append(graph-&gt;adjacency_list, (opal_list_item_t*)aj_list);</span>
<span class="lineNum">     261 </span>            :    /* point the vertex to the graph it belongs to (mostly for debug uses)*/
<span class="lineNum">     262 </span><span class="lineNoCov">          0 :    vertex-&gt;in_graph = graph;</span>
<span class="lineNum">     263 </span>            :    /* increase the number of vertices in the graph */
<span class="lineNum">     264 </span><span class="lineNoCov">          0 :    graph-&gt;number_of_vertices++;</span>
<span class="lineNum">     265 </span>            : }
<span class="lineNum">     266 </span>            : 
<span class="lineNum">     267 </span>            : 
<span class="lineNum">     268 </span>            : /**
<span class="lineNum">     269 </span>            :  * This graph API adds an edge (connection between two
<span class="lineNum">     270 </span>            :  * vertices) to a graph. The most common use
<span class="lineNum">     271 </span>            :  * for this API is while building a graph.
<span class="lineNum">     272 </span>            :  *
<span class="lineNum">     273 </span>            :  * @param graph The graph that this edge will be added to.
<span class="lineNum">     274 </span>            :  * @param edge The edge that we want to add.
<span class="lineNum">     275 </span>            :  *
<span class="lineNum">     276 </span>            :  * @return int Success or error. this API can return an error if
<a name="277"><span class="lineNum">     277 </span>            :  *         one of the vertices is not in the graph.</a>
<span class="lineNum">     278 </span>            :  */
<span class="lineNum">     279 </span><span class="lineNoCov">          0 : int opal_graph_add_edge(opal_graph_t *graph, opal_graph_edge_t *edge)</span>
<span class="lineNum">     280 </span>            : {
<span class="lineNum">     281 </span><span class="lineNoCov">          0 :     opal_adjacency_list_t *aj_list, *start_aj_list= NULL;</span>
<span class="lineNum">     282 </span>            :     opal_list_item_t *item;
<span class="lineNum">     283 </span><span class="lineNoCov">          0 :     bool start_found = false, end_found = false;</span>
<span class="lineNum">     284 </span>            : 
<span class="lineNum">     285 </span>            : 
<span class="lineNum">     286 </span>            :     /**
<span class="lineNum">     287 </span>            :      * find the vertices that this edge should connect.
<span class="lineNum">     288 </span>            :      */
<span class="lineNum">     289 </span><span class="lineNoCov">          0 :     for (item = opal_list_get_first(graph-&gt;adjacency_list);</span>
<span class="lineNum">     290 </span><span class="lineNoCov">          0 :          item != opal_list_get_end(graph-&gt;adjacency_list);</span>
<span class="lineNum">     291 </span><span class="lineNoCov">          0 :          item  = opal_list_get_next(item)) {</span>
<span class="lineNum">     292 </span><span class="lineNoCov">          0 :         aj_list = (opal_adjacency_list_t *) item;</span>
<span class="lineNum">     293 </span><span class="lineNoCov">          0 :         if (aj_list-&gt;vertex == edge-&gt;start) {</span>
<span class="lineNum">     294 </span><span class="lineNoCov">          0 :             start_found = true;</span>
<span class="lineNum">     295 </span><span class="lineNoCov">          0 :             start_aj_list = aj_list;</span>
<span class="lineNum">     296 </span>            :         }
<span class="lineNum">     297 </span><span class="lineNoCov">          0 :         if (aj_list-&gt;vertex == edge-&gt;end) {</span>
<span class="lineNum">     298 </span><span class="lineNoCov">          0 :             end_found = true;</span>
<span class="lineNum">     299 </span>            :         }
<span class="lineNum">     300 </span>            :     }
<span class="lineNum">     301 </span>            :     /**
<span class="lineNum">     302 </span>            :      * if one of the vertices either the start or the end is not
<span class="lineNum">     303 </span>            :      * found - return an error.
<span class="lineNum">     304 </span>            :      */
<span class="lineNum">     305 </span><span class="lineNoCov">          0 :     if (false == start_found &amp;&amp; false == end_found) {</span>
<span class="lineNum">     306 </span><span class="lineNoCov">          0 :         return OPAL_ERROR;</span>
<span class="lineNum">     307 </span>            :     }
<span class="lineNum">     308 </span>            :     /* point the edge to the adjacency list of the start vertex (for easy search) */
<span class="lineNum">     309 </span><span class="lineNoCov">          0 :     edge-&gt;in_adj_list=start_aj_list;</span>
<span class="lineNum">     310 </span>            :     /* append the edge to the adjacency list of the start vertex */
<span class="lineNum">     311 </span><span class="lineNoCov">          0 :     opal_list_append(start_aj_list-&gt;edges, (opal_list_item_t*)edge);</span>
<span class="lineNum">     312 </span>            :     /* increase the graph size */
<span class="lineNum">     313 </span><span class="lineNoCov">          0 :     graph-&gt;number_of_edges++;</span>
<span class="lineNum">     314 </span><span class="lineNoCov">          0 :     return OPAL_SUCCESS;</span>
<span class="lineNum">     315 </span>            : }
<span class="lineNum">     316 </span>            : 
<span class="lineNum">     317 </span>            : 
<span class="lineNum">     318 </span>            : /**
<span class="lineNum">     319 </span>            :  * This graph API removes an edge (a connection between two
<span class="lineNum">     320 </span>            :  * vertices) from the graph. The most common use of this API is
<span class="lineNum">     321 </span>            :  * while destructing a graph or while removing vertices from a
<span class="lineNum">     322 </span>            :  * graph. while removing vertices from a graph, we should also
<span class="lineNum">     323 </span>            :  * remove the connections from and to the vertices that we are
<span class="lineNum">     324 </span>            :  * removing.
<span class="lineNum">     325 </span>            :  *
<span class="lineNum">     326 </span>            :  * @param graph The graph that this edge will be remove from.
<a name="327"><span class="lineNum">     327 </span>            :  * @param edge the edge that we want to remove.</a>
<span class="lineNum">     328 </span>            :  */
<span class="lineNum">     329 </span><span class="lineNoCov">          0 : void opal_graph_remove_edge (opal_graph_t *graph, opal_graph_edge_t *edge)</span>
<span class="lineNum">     330 </span>            : {
<span class="lineNum">     331 </span>            :     /* remove the edge from the list it belongs to */
<span class="lineNum">     332 </span><span class="lineNoCov">          0 :     opal_list_remove_item(edge-&gt;in_adj_list-&gt;edges, (opal_list_item_t*)edge);</span>
<span class="lineNum">     333 </span>            :     /* decrees the number of edges in the graph */
<span class="lineNum">     334 </span><span class="lineNoCov">          0 :     graph-&gt;number_of_edges--;</span>
<span class="lineNum">     335 </span>            :     /* Note that the edge is not destructed - the caller should destruct this edge. */
<span class="lineNum">     336 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     337 </span>            : 
<span class="lineNum">     338 </span>            : /**
<span class="lineNum">     339 </span>            :  * This graph API remove a vertex from graph. The most common
<span class="lineNum">     340 </span>            :  * use for this API is while distracting a graph or while
<span class="lineNum">     341 </span>            :  * removing relevant vertices from a graph.
<span class="lineNum">     342 </span>            :  *
<span class="lineNum">     343 </span>            :  * @param graph The graph that the vertex will be remove from.
<span class="lineNum">     344 </span>            :  * @param vertex The vertex we want to remove.
<a name="345"><span class="lineNum">     345 </span>            :  */</a>
<span class="lineNum">     346 </span>            : 
<span class="lineNum">     347 </span><span class="lineNoCov">          0 : void opal_graph_remove_vertex(opal_graph_t *graph, opal_graph_vertex_t *vertex)</span>
<span class="lineNum">     348 </span>            : {
<span class="lineNum">     349 </span>            :     opal_adjacency_list_t *adj_list;
<span class="lineNum">     350 </span>            :     opal_graph_edge_t *edge;
<span class="lineNum">     351 </span>            : 
<span class="lineNum">     352 </span>            :     /**
<span class="lineNum">     353 </span>            :      * remove all the edges of this vertex and destruct them.
<span class="lineNum">     354 </span>            :      */
<span class="lineNum">     355 </span><span class="lineNoCov">          0 :     adj_list = vertex-&gt;in_adj_list;</span>
<span class="lineNum">     356 </span><span class="lineNoCov">          0 :     while (false == opal_list_is_empty(adj_list-&gt;edges)) {</span>
<span class="lineNum">     357 </span><span class="lineNoCov">          0 :         edge = (opal_graph_edge_t *)opal_list_remove_first(adj_list-&gt;edges);</span>
<span class="lineNum">     358 </span><span class="lineNoCov">          0 :         OBJ_RELEASE(edge);</span>
<span class="lineNum">     359 </span>            :     }
<span class="lineNum">     360 </span>            :     /**
<span class="lineNum">     361 </span>            :      * remove the adjscency list of this vertex from the graph and
<span class="lineNum">     362 </span>            :      * destruct it.
<span class="lineNum">     363 </span>            :      */
<span class="lineNum">     364 </span><span class="lineNoCov">          0 :     opal_list_remove_item(graph-&gt;adjacency_list, (opal_list_item_t*)adj_list);</span>
<span class="lineNum">     365 </span><span class="lineNoCov">          0 :     OBJ_RELEASE(adj_list);</span>
<span class="lineNum">     366 </span>            :     /**
<span class="lineNum">     367 </span>            :      * delete all the edges that connected *to* the vertex.
<span class="lineNum">     368 </span>            :      */
<span class="lineNum">     369 </span><span class="lineNoCov">          0 :     delete_all_edges_conceded_to_vertex(graph, vertex);</span>
<span class="lineNum">     370 </span>            :     /* destruct the vertex */
<span class="lineNum">     371 </span><span class="lineNoCov">          0 :     OBJ_RELEASE(vertex);</span>
<span class="lineNum">     372 </span>            :     /* decrease the number of vertices in the graph. */
<span class="lineNum">     373 </span><span class="lineNoCov">          0 :     graph-&gt;number_of_vertices--;</span>
<span class="lineNum">     374 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     375 </span>            : 
<span class="lineNum">     376 </span>            : /**
<span class="lineNum">     377 </span>            :  * This graph API tell us if two vertices are adjacent
<span class="lineNum">     378 </span>            :  *
<span class="lineNum">     379 </span>            :  * @param graph The graph that the vertices belongs to.
<span class="lineNum">     380 </span>            :  * @param vertex1 first vertex.
<span class="lineNum">     381 </span>            :  * @param vertex2 second vertex.
<span class="lineNum">     382 </span>            :  *
<span class="lineNum">     383 </span>            :  * @return uint32_t the weight of the connection between the two
<span class="lineNum">     384 </span>            :  *         vertices or infinity if the vertices are not
<a name="385"><span class="lineNum">     385 </span>            :  *         connected.</a>
<span class="lineNum">     386 </span>            :  */
<span class="lineNum">     387 </span><span class="lineNoCov">          0 : uint32_t opal_graph_adjacent(opal_graph_t *graph, opal_graph_vertex_t *vertex1, opal_graph_vertex_t *vertex2)</span>
<span class="lineNum">     388 </span>            : {
<span class="lineNum">     389 </span>            :     opal_adjacency_list_t *adj_list;
<span class="lineNum">     390 </span>            :     opal_list_item_t *item;
<span class="lineNum">     391 </span>            :     opal_graph_edge_t *edge;
<span class="lineNum">     392 </span>            : 
<span class="lineNum">     393 </span>            :     /**
<span class="lineNum">     394 </span>            :      * Verify that the first vertex belongs to the graph.
<span class="lineNum">     395 </span>            :      */
<span class="lineNum">     396 </span><span class="lineNoCov">          0 :     if (graph != vertex1-&gt;in_graph) {</span>
<span class="lineNum">     397 </span><span class="lineNoCov">          0 :         OPAL_OUTPUT((0,&quot;opal_graph_adjacent 1 Vertex1 %p not in the graph %p\n&quot;,(void *)vertex1,(void *)graph));</span>
<span class="lineNum">     398 </span><span class="lineNoCov">          0 :         return DISTANCE_INFINITY;</span>
<span class="lineNum">     399 </span>            :     }
<span class="lineNum">     400 </span>            :     /**
<span class="lineNum">     401 </span>            :      * Verify that the second vertex belongs to the graph.
<span class="lineNum">     402 </span>            :      */
<span class="lineNum">     403 </span><span class="lineNoCov">          0 :     if (graph != vertex2-&gt;in_graph) {</span>
<span class="lineNum">     404 </span><span class="lineNoCov">          0 :         OPAL_OUTPUT((0,&quot;opal_graph_adjacent 2 Vertex2 %p not in the graph %p\n&quot;,(void *)vertex2,(void *)graph));</span>
<span class="lineNum">     405 </span><span class="lineNoCov">          0 :         return DISTANCE_INFINITY;</span>
<span class="lineNum">     406 </span>            :     }
<span class="lineNum">     407 </span>            :     /**
<span class="lineNum">     408 </span>            :      * If the first vertex and the second vertex are the same
<span class="lineNum">     409 </span>            :      * vertex, the distance between the is 0.
<span class="lineNum">     410 </span>            :      */
<span class="lineNum">     411 </span><span class="lineNoCov">          0 :     if (vertex1 == vertex2) {</span>
<span class="lineNum">     412 </span><span class="lineNoCov">          0 :         return 0;</span>
<span class="lineNum">     413 </span>            :     }
<span class="lineNum">     414 </span>            :     /**
<span class="lineNum">     415 </span>            :      * find the second vertex in the adjacency list of the first
<span class="lineNum">     416 </span>            :      * vertex.
<span class="lineNum">     417 </span>            :      */
<span class="lineNum">     418 </span><span class="lineNoCov">          0 :     adj_list = (opal_adjacency_list_t *) vertex1-&gt;in_adj_list;</span>
<span class="lineNum">     419 </span><span class="lineNoCov">          0 :     for (item = opal_list_get_first(adj_list-&gt;edges);</span>
<span class="lineNum">     420 </span><span class="lineNoCov">          0 :          item != opal_list_get_end(adj_list-&gt;edges);</span>
<span class="lineNum">     421 </span><span class="lineNoCov">          0 :          item  = opal_list_get_next(item)) {</span>
<span class="lineNum">     422 </span><span class="lineNoCov">          0 :         edge = (opal_graph_edge_t *)item;</span>
<span class="lineNum">     423 </span><span class="lineNoCov">          0 :         if (edge-&gt;end == vertex2) {</span>
<span class="lineNum">     424 </span>            :             /* if the second vertex was found in the adjacency list of the first one, return the weight */
<span class="lineNum">     425 </span><span class="lineNoCov">          0 :             return edge-&gt;weight;</span>
<span class="lineNum">     426 </span>            :         }
<span class="lineNum">     427 </span>            :     }
<span class="lineNum">     428 </span>            :     /* if the second vertex was not found in the adjacency list of the first one, return infinity */
<span class="lineNum">     429 </span><span class="lineNoCov">          0 :     return DISTANCE_INFINITY;</span>
<span class="lineNum">     430 </span>            : }
<span class="lineNum">     431 </span>            : 
<span class="lineNum">     432 </span>            : /**
<span class="lineNum">     433 </span>            :  * This Graph API returns the order of the graph (number of
<span class="lineNum">     434 </span>            :  * vertices)
<span class="lineNum">     435 </span>            :  *
<span class="lineNum">     436 </span>            :  * @param graph
<span class="lineNum">     437 </span>            :  *
<a name="438"><span class="lineNum">     438 </span>            :  * @return int</a>
<span class="lineNum">     439 </span>            :  */
<span class="lineNum">     440 </span><span class="lineNoCov">          0 : int opal_graph_get_order(opal_graph_t *graph)</span>
<span class="lineNum">     441 </span>            : {
<span class="lineNum">     442 </span><span class="lineNoCov">          0 :     return graph-&gt;number_of_vertices;</span>
<span class="lineNum">     443 </span>            : }
<span class="lineNum">     444 </span>            : 
<span class="lineNum">     445 </span>            : /**
<span class="lineNum">     446 </span>            :  * This Graph API returns the size of the graph (number of
<span class="lineNum">     447 </span>            :  * edges)
<span class="lineNum">     448 </span>            :  *
<span class="lineNum">     449 </span>            :  * @param graph
<span class="lineNum">     450 </span>            :  *
<a name="451"><span class="lineNum">     451 </span>            :  * @return int</a>
<span class="lineNum">     452 </span>            :  */
<span class="lineNum">     453 </span><span class="lineNoCov">          0 : int opal_graph_get_size(opal_graph_t *graph)</span>
<span class="lineNum">     454 </span>            : {
<span class="lineNum">     455 </span><span class="lineNoCov">          0 :     return graph-&gt;number_of_edges;</span>
<span class="lineNum">     456 </span>            : }
<span class="lineNum">     457 </span>            : 
<span class="lineNum">     458 </span>            : /**
<span class="lineNum">     459 </span>            :  * This graph API finds a vertex in the graph according the
<span class="lineNum">     460 </span>            :  * vertex data.
<span class="lineNum">     461 </span>            :  * @param graph the graph we searching in.
<span class="lineNum">     462 </span>            :  * @param vertex_data the vertex data we are searching according
<span class="lineNum">     463 </span>            :  *                    to.
<span class="lineNum">     464 </span>            :  *
<a name="465"><span class="lineNum">     465 </span>            :  * @return opal_graph_vertex_t* The vertex founded or NULL.</a>
<span class="lineNum">     466 </span>            :  */
<span class="lineNum">     467 </span><span class="lineNoCov">          0 : opal_graph_vertex_t *opal_graph_find_vertex(opal_graph_t *graph, void *vertex_data)</span>
<span class="lineNum">     468 </span>            : {
<span class="lineNum">     469 </span>            :     opal_adjacency_list_t *aj_list;
<span class="lineNum">     470 </span>            :     opal_list_item_t *item;
<span class="lineNum">     471 </span>            : 
<span class="lineNum">     472 </span>            :     /**
<span class="lineNum">     473 </span>            :      * Run on all the vertices of the graph
<span class="lineNum">     474 </span>            :      */
<span class="lineNum">     475 </span><span class="lineNoCov">          0 :     for (item = opal_list_get_first(graph-&gt;adjacency_list);</span>
<span class="lineNum">     476 </span><span class="lineNoCov">          0 :          item != opal_list_get_end(graph-&gt;adjacency_list);</span>
<span class="lineNum">     477 </span><span class="lineNoCov">          0 :          item  = opal_list_get_next(item)) {</span>
<span class="lineNum">     478 </span><span class="lineNoCov">          0 :         aj_list = (opal_adjacency_list_t *) item;</span>
<span class="lineNum">     479 </span><span class="lineNoCov">          0 :         if (NULL != aj_list-&gt;vertex-&gt;compare_vertex) {</span>
<span class="lineNum">     480 </span>            :             /* if the vertex data of a vertex is equal to the vertex data */
<span class="lineNum">     481 </span><span class="lineNoCov">          0 :             if (0 == aj_list-&gt;vertex-&gt;compare_vertex(aj_list-&gt;vertex-&gt;vertex_data, vertex_data)) {</span>
<span class="lineNum">     482 </span>            :                 /* return the found vertex */
<span class="lineNum">     483 </span><span class="lineNoCov">          0 :                 return aj_list-&gt;vertex;</span>
<span class="lineNum">     484 </span>            :             }
<span class="lineNum">     485 </span>            :         }
<span class="lineNum">     486 </span>            :     }
<span class="lineNum">     487 </span>            :     /* if a vertex is not found, return NULL */
<span class="lineNum">     488 </span><span class="lineNoCov">          0 :     return NULL;</span>
<span class="lineNum">     489 </span>            : }
<span class="lineNum">     490 </span>            : 
<span class="lineNum">     491 </span>            : 
<span class="lineNum">     492 </span>            : /**
<span class="lineNum">     493 </span>            :  * This graph API returns an array of pointers of all the
<span class="lineNum">     494 </span>            :  * vertices in the graph.
<span class="lineNum">     495 </span>            :  *
<span class="lineNum">     496 </span>            :  *
<span class="lineNum">     497 </span>            :  * @param graph
<span class="lineNum">     498 </span>            :  * @param vertices_list an array of pointers of all the
<span class="lineNum">     499 </span>            :  *         vertices in the graph vertices.
<span class="lineNum">     500 </span>            :  *
<span class="lineNum">     501 </span>            :  * @return int returning the graph order (the
<a name="502"><span class="lineNum">     502 </span>            :  *                    number of vertices in the returned array)</a>
<span class="lineNum">     503 </span>            :  */
<span class="lineNum">     504 </span><span class="lineNoCov">          0 : int opal_graph_get_graph_vertices(opal_graph_t *graph, opal_pointer_array_t *vertices_list)</span>
<span class="lineNum">     505 </span>            : {
<span class="lineNum">     506 </span>            :     opal_adjacency_list_t *aj_list;
<span class="lineNum">     507 </span>            :     opal_list_item_t *item;
<span class="lineNum">     508 </span>            :     int i;
<span class="lineNum">     509 </span>            : 
<span class="lineNum">     510 </span>            :     /**
<span class="lineNum">     511 </span>            :      * If the graph order is 0, return NULL.
<span class="lineNum">     512 </span>            :      */
<span class="lineNum">     513 </span><span class="lineNoCov">          0 :     if (0 == graph-&gt;number_of_vertices) {</span>
<span class="lineNum">     514 </span><span class="lineNoCov">          0 :         return 0;</span>
<span class="lineNum">     515 </span>            :     }
<span class="lineNum">     516 </span>            :     /* Run on all the vertices of the graph */
<span class="lineNum">     517 </span><span class="lineNoCov">          0 :     for (item = opal_list_get_first(graph-&gt;adjacency_list), i = 0;</span>
<span class="lineNum">     518 </span><span class="lineNoCov">          0 :          item != opal_list_get_end(graph-&gt;adjacency_list);</span>
<span class="lineNum">     519 </span><span class="lineNoCov">          0 :          item  = opal_list_get_next(item), i++) {</span>
<span class="lineNum">     520 </span><span class="lineNoCov">          0 :         aj_list = (opal_adjacency_list_t *) item;</span>
<span class="lineNum">     521 </span>            :         /* Add the vertex to the vertices array */
<span class="lineNum">     522 </span><span class="lineNoCov">          0 :         opal_pointer_array_add(vertices_list,(void *)aj_list-&gt;vertex);</span>
<span class="lineNum">     523 </span>            :     }
<span class="lineNum">     524 </span>            :     /* return the vertices list */
<span class="lineNum">     525 </span><span class="lineNoCov">          0 :     return graph-&gt;number_of_vertices;</span>
<span class="lineNum">     526 </span>            : }
<span class="lineNum">     527 </span>            : 
<span class="lineNum">     528 </span>            : /**
<span class="lineNum">     529 </span>            :  * This graph API returns all the adjacents of a vertex and the
<span class="lineNum">     530 </span>            :  * distance (weight) of those adjacents and the vertex.
<span class="lineNum">     531 </span>            :  *
<span class="lineNum">     532 </span>            :  * @param graph
<span class="lineNum">     533 </span>            :  * @param vertex The reference vertex
<span class="lineNum">     534 </span>            :  * @param adjacents An allocated pointer array of vertices and
<span class="lineNum">     535 </span>            :  *                  their distance from the reference vertex.
<span class="lineNum">     536 </span>            :  *                  Note that this pointer should be free after
<span class="lineNum">     537 </span>            :  *                  usage by the user
<span class="lineNum">     538 </span>            :  *
<a name="539"><span class="lineNum">     539 </span>            :  * @return int the number of adjacents in the list.</a>
<span class="lineNum">     540 </span>            :  */
<span class="lineNum">     541 </span><span class="lineNoCov">          0 : int opal_graph_get_adjacent_vertices(opal_graph_t *graph, opal_graph_vertex_t *vertex, opal_value_array_t *adjacents)</span>
<span class="lineNum">     542 </span>            : {
<span class="lineNum">     543 </span>            :     opal_adjacency_list_t *adj_list;
<span class="lineNum">     544 </span>            :     opal_graph_edge_t *edge;
<span class="lineNum">     545 </span>            :     int adjacents_number;
<span class="lineNum">     546 </span>            :     opal_list_item_t *item;
<span class="lineNum">     547 </span>            :     vertex_distance_from_t distance_from;
<span class="lineNum">     548 </span>            :     int i;
<span class="lineNum">     549 </span>            : 
<span class="lineNum">     550 </span>            :     /**
<span class="lineNum">     551 </span>            :      * Verify that the vertex belongs to the graph.
<span class="lineNum">     552 </span>            :      */
<span class="lineNum">     553 </span><span class="lineNoCov">          0 :     if (graph != vertex-&gt;in_graph) {</span>
<span class="lineNum">     554 </span><span class="lineNoCov">          0 :         OPAL_OUTPUT((0,&quot;Vertex %p not in the graph %p\n&quot;, (void *)vertex, (void *)graph));</span>
<span class="lineNum">     555 </span><span class="lineNoCov">          0 :         return 0;</span>
<span class="lineNum">     556 </span>            :     }
<span class="lineNum">     557 </span>            :     /**
<span class="lineNum">     558 </span>            :      * find the adjacency list that this vertex belongs to
<span class="lineNum">     559 </span>            :      */
<span class="lineNum">     560 </span><span class="lineNoCov">          0 :     adj_list = (opal_adjacency_list_t *) vertex-&gt;in_adj_list;</span>
<span class="lineNum">     561 </span>            :     /* find the number of adjcents of this vertex */
<span class="lineNum">     562 </span><span class="lineNoCov">          0 :     adjacents_number = opal_list_get_size(adj_list-&gt;edges);</span>
<span class="lineNum">     563 </span>            :     /* Run on all the edges from this vertex */
<span class="lineNum">     564 </span><span class="lineNoCov">          0 :     for (item = opal_list_get_first(adj_list-&gt;edges), i = 0;</span>
<span class="lineNum">     565 </span><span class="lineNoCov">          0 :          item != opal_list_get_end(adj_list-&gt;edges);</span>
<span class="lineNum">     566 </span><span class="lineNoCov">          0 :          item  = opal_list_get_next(item), i++) {</span>
<span class="lineNum">     567 </span><span class="lineNoCov">          0 :         edge = (opal_graph_edge_t *)item;</span>
<span class="lineNum">     568 </span>            :         /* assign vertices and their weight in the adjcents list */
<span class="lineNum">     569 </span><span class="lineNoCov">          0 :         distance_from.vertex = edge-&gt;end;</span>
<span class="lineNum">     570 </span><span class="lineNoCov">          0 :         distance_from.weight = edge-&gt;weight;</span>
<span class="lineNum">     571 </span><span class="lineNoCov">          0 :         opal_value_array_append_item(adjacents, &amp;distance_from);</span>
<span class="lineNum">     572 </span>            :     }
<span class="lineNum">     573 </span>            :     /* return the number of the adjacents in the list */
<span class="lineNum">     574 </span><span class="lineNoCov">          0 :     return adjacents_number;</span>
<span class="lineNum">     575 </span>            : }
<span class="lineNum">     576 </span>            : 
<span class="lineNum">     577 </span>            : /**
<span class="lineNum">     578 </span>            :  * This graph API finds the shortest path between two vertices.
<span class="lineNum">     579 </span>            :  *
<span class="lineNum">     580 </span>            :  * @param graph
<span class="lineNum">     581 </span>            :  * @param vertex1 The start vertex.
<span class="lineNum">     582 </span>            :  * @param vertex2 The end vertex.
<span class="lineNum">     583 </span>            :  *
<span class="lineNum">     584 </span>            :  * @return uint32_t the distance between the two vertices.
<a name="585"><span class="lineNum">     585 </span>            :  */</a>
<span class="lineNum">     586 </span>            : 
<span class="lineNum">     587 </span><span class="lineNoCov">          0 : uint32_t opal_graph_spf(opal_graph_t *graph, opal_graph_vertex_t *vertex1, opal_graph_vertex_t *vertex2)</span>
<span class="lineNum">     588 </span>            : {
<span class="lineNum">     589 </span>            :     opal_value_array_t *distance_array;
<span class="lineNum">     590 </span><span class="lineNoCov">          0 :     uint32_t items_in_distance_array, spf = DISTANCE_INFINITY;</span>
<span class="lineNum">     591 </span>            :     vertex_distance_from_t *vertex_distance;
<span class="lineNum">     592 </span>            :     uint32_t i;
<span class="lineNum">     593 </span>            : 
<span class="lineNum">     594 </span>            :     /**
<span class="lineNum">     595 </span>            :      * Verify that the first vertex belongs to the graph.
<span class="lineNum">     596 </span>            :      */
<span class="lineNum">     597 </span><span class="lineNoCov">          0 :     if (graph != vertex1-&gt;in_graph) {</span>
<span class="lineNum">     598 </span><span class="lineNoCov">          0 :         OPAL_OUTPUT((0,&quot;opal_graph_spf 1 Vertex1 %p not in the graph %p\n&quot;,(void *)vertex1,(void *)graph));</span>
<span class="lineNum">     599 </span><span class="lineNoCov">          0 :         return DISTANCE_INFINITY;</span>
<span class="lineNum">     600 </span>            :     }
<span class="lineNum">     601 </span>            :     /**
<span class="lineNum">     602 </span>            :      * Verify that the second vertex belongs to the graph.
<span class="lineNum">     603 </span>            :      */
<span class="lineNum">     604 </span><span class="lineNoCov">          0 :     if (graph != vertex2-&gt;in_graph) {</span>
<span class="lineNum">     605 </span><span class="lineNoCov">          0 :         OPAL_OUTPUT((0,&quot;opal_graph_spf 2 Vertex2 %p not in the graph %p\n&quot;,(void *)vertex2,(void *)graph));</span>
<span class="lineNum">     606 </span><span class="lineNoCov">          0 :         return DISTANCE_INFINITY;</span>
<span class="lineNum">     607 </span>            :     }
<span class="lineNum">     608 </span>            :     /**
<span class="lineNum">     609 </span>            :      * Run Dijkstra algorithm on the graph from the start vertex.
<span class="lineNum">     610 </span>            :      */
<span class="lineNum">     611 </span><span class="lineNoCov">          0 :     distance_array = OBJ_NEW(opal_value_array_t);</span>
<span class="lineNum">     612 </span><span class="lineNoCov">          0 :     opal_value_array_init(distance_array, sizeof(vertex_distance_from_t));</span>
<span class="lineNum">     613 </span><span class="lineNoCov">          0 :     opal_value_array_reserve(distance_array,50);</span>
<span class="lineNum">     614 </span><span class="lineNoCov">          0 :     items_in_distance_array = opal_graph_dijkstra(graph, vertex1, distance_array);</span>
<span class="lineNum">     615 </span>            :     /**
<span class="lineNum">     616 </span>            :      * find the end vertex in the distance array that Dijkstra
<span class="lineNum">     617 </span>            :      * algorithm returned.
<span class="lineNum">     618 </span>            :      */
<span class="lineNum">     619 </span><span class="lineNoCov">          0 :     for (i = 0; i &lt; items_in_distance_array; i++) {</span>
<span class="lineNum">     620 </span><span class="lineNoCov">          0 :         vertex_distance = opal_value_array_get_item(distance_array, i);</span>
<span class="lineNum">     621 </span><span class="lineNoCov">          0 :         if (vertex_distance-&gt;vertex == vertex2) {</span>
<span class="lineNum">     622 </span><span class="lineNoCov">          0 :             spf = vertex_distance-&gt;weight;</span>
<span class="lineNum">     623 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     624 </span>            :         }
<span class="lineNum">     625 </span>            :     }
<span class="lineNum">     626 </span><span class="lineNoCov">          0 :     OBJ_RELEASE(distance_array);</span>
<span class="lineNum">     627 </span>            :     /* return the distance (weight) to the end vertex */
<span class="lineNum">     628 </span><span class="lineNoCov">          0 :     return spf;</span>
<span class="lineNum">     629 </span>            : }
<span class="lineNum">     630 </span>            : 
<span class="lineNum">     631 </span>            : /**
<span class="lineNum">     632 </span>            :  * Compare the distance between two vertex distance items. this
<span class="lineNum">     633 </span>            :  * function is used for sorting an array of vertices distance by
<span class="lineNum">     634 </span>            :  * qsort function.
<span class="lineNum">     635 </span>            :  *
<span class="lineNum">     636 </span>            :  * @param item1 a void pointer to vertex distance structure
<span class="lineNum">     637 </span>            :  * @param item2 a void pointer to vertex distance structure
<span class="lineNum">     638 </span>            :  *
<span class="lineNum">     639 </span>            :  * @return int 1 - the first item weight is higher then the
<span class="lineNum">     640 </span>            :  *         second item weight. 0 - the weights are equal. -1 -
<span class="lineNum">     641 </span>            :  *         the second item weight is higher the the first item
<a name="642"><span class="lineNum">     642 </span>            :  *         weight.</a>
<span class="lineNum">     643 </span>            :  */
<span class="lineNum">     644 </span><span class="lineNoCov">          0 : static int compare_vertex_distance(const void *item1, const void *item2)</span>
<span class="lineNum">     645 </span>            : {
<span class="lineNum">     646 </span>            :     vertex_distance_from_t *vertex_dist1, *vertex_dist2;
<span class="lineNum">     647 </span>            : 
<span class="lineNum">     648 </span>            :     /* convert the void pointers to vertex distance pointers. */
<span class="lineNum">     649 </span><span class="lineNoCov">          0 :     vertex_dist1 = (vertex_distance_from_t *)item1;</span>
<span class="lineNum">     650 </span><span class="lineNoCov">          0 :     vertex_dist2 = (vertex_distance_from_t *)item2;</span>
<span class="lineNum">     651 </span>            : 
<span class="lineNum">     652 </span>            :     /* If the first item weight is higher then the second item weight return 1*/
<span class="lineNum">     653 </span><span class="lineNoCov">          0 :     if (vertex_dist1-&gt;weight &gt; vertex_dist2-&gt;weight) {</span>
<span class="lineNum">     654 </span><span class="lineNoCov">          0 :         return 1;</span>
<span class="lineNum">     655 </span>            :     }
<span class="lineNum">     656 </span>            :     /* If they are equal return 0 */
<span class="lineNum">     657 </span><span class="lineNoCov">          0 :     else if (vertex_dist1-&gt;weight == vertex_dist2-&gt;weight) {</span>
<span class="lineNum">     658 </span><span class="lineNoCov">          0 :         return 0;</span>
<span class="lineNum">     659 </span>            :     }
<span class="lineNum">     660 </span>            :     /* if you reached here then the second item weight is higher the the first item weight */
<span class="lineNum">     661 </span><span class="lineNoCov">          0 :     return -1;</span>
<span class="lineNum">     662 </span>            : }
<span class="lineNum">     663 </span>            : 
<span class="lineNum">     664 </span>            : 
<span class="lineNum">     665 </span>            : /**
<span class="lineNum">     666 </span>            :  * This graph API returns the distance (weight) from a reference
<span class="lineNum">     667 </span>            :  * vertex to all other vertices in the graph using the Dijkstra
<span class="lineNum">     668 </span>            :  * algorithm
<span class="lineNum">     669 </span>            :  *
<span class="lineNum">     670 </span>            :  * @param graph
<span class="lineNum">     671 </span>            :  * @param vertex The reference vertex.
<span class="lineNum">     672 </span>            :  * @param distance_array An array of vertices and
<span class="lineNum">     673 </span>            :  *         their distance from the reference vertex.
<span class="lineNum">     674 </span>            :  *
<a name="675"><span class="lineNum">     675 </span>            :  * @return uint32_t the size of the distance array</a>
<span class="lineNum">     676 </span>            :  */
<span class="lineNum">     677 </span><span class="lineNoCov">          0 : uint32_t opal_graph_dijkstra(opal_graph_t *graph, opal_graph_vertex_t *vertex, opal_value_array_t *distance_array)</span>
<span class="lineNum">     678 </span>            : {
<span class="lineNum">     679 </span>            :     int graph_order;
<span class="lineNum">     680 </span>            :     vertex_distance_from_t *Q, *q_start, *current_vertex;
<span class="lineNum">     681 </span>            :     opal_list_item_t *adj_list_item;
<span class="lineNum">     682 </span>            :     opal_adjacency_list_t *adj_list;
<span class="lineNum">     683 </span>            :     int number_of_items_in_q;
<span class="lineNum">     684 </span>            :     int i;
<span class="lineNum">     685 </span>            :     uint32_t weight;
<span class="lineNum">     686 </span>            : 
<span class="lineNum">     687 </span>            : 
<span class="lineNum">     688 </span>            :     /**
<span class="lineNum">     689 </span>            :      * Verify that the reference vertex belongs to the graph.
<span class="lineNum">     690 </span>            :      */
<span class="lineNum">     691 </span><span class="lineNoCov">          0 :     if (graph != vertex-&gt;in_graph) {</span>
<span class="lineNum">     692 </span><span class="lineNoCov">          0 :         OPAL_OUTPUT((0,&quot;opal:graph:dijkstra: vertex %p not in the graph %p\n&quot;,(void *)vertex,(void *)graph));</span>
<span class="lineNum">     693 </span><span class="lineNoCov">          0 :         return 0;</span>
<span class="lineNum">     694 </span>            :     }
<span class="lineNum">     695 </span>            :     /* get the order of the graph and allocate a working queue accordingly */
<span class="lineNum">     696 </span><span class="lineNoCov">          0 :     graph_order = opal_graph_get_order(graph);</span>
<span class="lineNum">     697 </span><span class="lineNoCov">          0 :     Q = (vertex_distance_from_t *)malloc(graph_order * sizeof(vertex_distance_from_t));</span>
<span class="lineNum">     698 </span>            :     /* assign a pointer to the start of the queue */
<span class="lineNum">     699 </span><span class="lineNoCov">          0 :     q_start = Q;</span>
<span class="lineNum">     700 </span>            :     /* run on all the vertices of the graph */
<span class="lineNum">     701 </span><span class="lineNoCov">          0 :     for (adj_list_item = opal_list_get_first(graph-&gt;adjacency_list), i=0;</span>
<span class="lineNum">     702 </span><span class="lineNoCov">          0 :          adj_list_item != opal_list_get_end(graph-&gt;adjacency_list);</span>
<span class="lineNum">     703 </span><span class="lineNoCov">          0 :          adj_list_item  = opal_list_get_next(adj_list_item), i++) {</span>
<span class="lineNum">     704 </span><span class="lineNoCov">          0 :         adj_list = (opal_adjacency_list_t *)adj_list_item;</span>
<span class="lineNum">     705 </span>            :         /* insert the vertices pointes to the working queue */
<span class="lineNum">     706 </span><span class="lineNoCov">          0 :         Q[i].vertex = adj_list-&gt;vertex;</span>
<span class="lineNum">     707 </span>            :         /**
<span class="lineNum">     708 </span>            :          * assign an infinity distance to all the vertices in the queue
<span class="lineNum">     709 </span>            :          * except the reference vertex which its distance should be 0.
<span class="lineNum">     710 </span>            :          */
<span class="lineNum">     711 </span><span class="lineNoCov">          0 :         if (Q[i].vertex == vertex) {</span>
<span class="lineNum">     712 </span><span class="lineNoCov">          0 :             Q[i].weight = 0;</span>
<span class="lineNum">     713 </span>            :         }
<span class="lineNum">     714 </span>            :         else {
<span class="lineNum">     715 </span><span class="lineNoCov">          0 :             Q[i].weight = DISTANCE_INFINITY;</span>
<span class="lineNum">     716 </span>            :         }
<span class="lineNum">     717 </span>            :     }
<span class="lineNum">     718 </span><span class="lineNoCov">          0 :     number_of_items_in_q = i;</span>
<span class="lineNum">     719 </span>            :     /* sort the working queue according the distance from the reference vertex */
<span class="lineNum">     720 </span><span class="lineNoCov">          0 :     qsort(q_start, number_of_items_in_q, sizeof(vertex_distance_from_t), compare_vertex_distance);</span>
<span class="lineNum">     721 </span>            :     /* while the working queue is not empty */
<span class="lineNum">     722 </span><span class="lineNoCov">          0 :     while (number_of_items_in_q &gt; 0) {</span>
<span class="lineNum">     723 </span>            :         /* start to work with the first vertex in the working queue */
<span class="lineNum">     724 </span><span class="lineNoCov">          0 :         current_vertex = q_start;</span>
<span class="lineNum">     725 </span>            :         /* remove the first vertex from the queue */
<span class="lineNum">     726 </span><span class="lineNoCov">          0 :         q_start++;</span>
<span class="lineNum">     727 </span>            :         /* decrees the number of vertices in the queue */
<span class="lineNum">     728 </span><span class="lineNoCov">          0 :         number_of_items_in_q--;</span>
<span class="lineNum">     729 </span>            :         /* find the distance of all other vertices in the queue from the first vertex in the queue */
<span class="lineNum">     730 </span><span class="lineNoCov">          0 :         for (i = 0; i &lt; number_of_items_in_q; i++) {</span>
<span class="lineNum">     731 </span><span class="lineNoCov">          0 :             weight = opal_graph_adjacent(graph, current_vertex-&gt;vertex, q_start[i].vertex);</span>
<span class="lineNum">     732 </span>            :             /**
<span class="lineNum">     733 </span>            :              * if the distance from the first vertex in the queue to the I
<span class="lineNum">     734 </span>            :              * vertex in the queue plus the distance of the first vertex in
<span class="lineNum">     735 </span>            :              * the queue from the referenced vertex is smaller than the
<span class="lineNum">     736 </span>            :              * distance of the I vertex from the referenced vertex, assign
<span class="lineNum">     737 </span>            :              * the lower distance to the I vertex.
<span class="lineNum">     738 </span>            :              */
<span class="lineNum">     739 </span><span class="lineNoCov">          0 :             if (current_vertex-&gt;weight + weight &lt; q_start[i].weight) {</span>
<span class="lineNum">     740 </span><span class="lineNoCov">          0 :                 q_start[i].weight = weight + current_vertex-&gt;weight;</span>
<span class="lineNum">     741 </span>            :             }
<span class="lineNum">     742 </span>            :         }
<span class="lineNum">     743 </span>            :         /* sort again the working queue */
<span class="lineNum">     744 </span><span class="lineNoCov">          0 :         qsort(q_start, number_of_items_in_q, sizeof(vertex_distance_from_t), compare_vertex_distance);</span>
<span class="lineNum">     745 </span>            :     }
<span class="lineNum">     746 </span>            :     /* copy the working queue the the returned distance array */
<span class="lineNum">     747 </span><span class="lineNoCov">          0 :     for (i = 0; i &lt; graph_order-1; i++) {</span>
<span class="lineNum">     748 </span><span class="lineNoCov">          0 :         opal_value_array_append_item(distance_array, (void *)&amp;(Q[i+1]));</span>
<span class="lineNum">     749 </span>            :     }
<span class="lineNum">     750 </span>            :     /* free the working queue */
<span class="lineNum">     751 </span><span class="lineNoCov">          0 :     free(Q);</span>
<span class="lineNum">     752 </span>            :     /* assign the distance array size. */
<span class="lineNum">     753 </span><span class="lineNoCov">          0 :     return graph_order - 1;</span>
<span class="lineNum">     754 </span>            : }
<span class="lineNum">     755 </span>            : 
<span class="lineNum">     756 </span>            : 
<span class="lineNum">     757 </span>            : /**
<span class="lineNum">     758 </span>            :  * This graph API duplicates a graph. Note that this API does
<span class="lineNum">     759 </span>            :  * not copy the graph but builds a new graph while coping just
<span class="lineNum">     760 </span>            :  * the vertex data.
<span class="lineNum">     761 </span>            :  *
<span class="lineNum">     762 </span>            :  * @param dest The new created graph.
<a name="763"><span class="lineNum">     763 </span>            :  * @param src The graph we want to duplicate.</a>
<span class="lineNum">     764 </span>            :  */
<span class="lineNum">     765 </span><span class="lineNoCov">          0 : void opal_graph_duplicate(opal_graph_t **dest, opal_graph_t *src)</span>
<span class="lineNum">     766 </span>            : {
<span class="lineNum">     767 </span>            :     opal_adjacency_list_t *aj_list;
<span class="lineNum">     768 </span>            :     opal_list_item_t *aj_list_item, *edg_item;
<span class="lineNum">     769 </span>            :     opal_graph_vertex_t *vertex;
<span class="lineNum">     770 </span>            :     opal_graph_edge_t *edge, *new_edge;
<span class="lineNum">     771 </span>            : 
<span class="lineNum">     772 </span>            :     /* construct a new graph */
<span class="lineNum">     773 </span><span class="lineNoCov">          0 :     *dest = OBJ_NEW(opal_graph_t);</span>
<span class="lineNum">     774 </span>            :     /* Run on all the vertices of the src graph */
<span class="lineNum">     775 </span><span class="lineNoCov">          0 :     for (aj_list_item = opal_list_get_first(src-&gt;adjacency_list);</span>
<span class="lineNum">     776 </span><span class="lineNoCov">          0 :          aj_list_item != opal_list_get_end(src-&gt;adjacency_list);</span>
<span class="lineNum">     777 </span><span class="lineNoCov">          0 :          aj_list_item  = opal_list_get_next(aj_list_item)) {</span>
<span class="lineNum">     778 </span><span class="lineNoCov">          0 :         aj_list = (opal_adjacency_list_t *) aj_list_item;</span>
<span class="lineNum">     779 </span>            :         /* for each vertex in the src graph, construct a new vertex */
<span class="lineNum">     780 </span><span class="lineNoCov">          0 :         vertex = OBJ_NEW(opal_graph_vertex_t);</span>
<span class="lineNum">     781 </span>            :         /* associate the new vertex to a vertex from the original graph */
<span class="lineNum">     782 </span><span class="lineNoCov">          0 :         vertex-&gt;sibling = aj_list-&gt;vertex;</span>
<span class="lineNum">     783 </span>            :         /* associate the original vertex to the new constructed vertex */
<span class="lineNum">     784 </span><span class="lineNoCov">          0 :         aj_list-&gt;vertex-&gt;sibling = vertex;</span>
<span class="lineNum">     785 </span>            :         /* allocate space to vertex data in the new vertex */
<span class="lineNum">     786 </span><span class="lineNoCov">          0 :         if (NULL != aj_list-&gt;vertex-&gt;alloc_vertex_data) {</span>
<span class="lineNum">     787 </span><span class="lineNoCov">          0 :             vertex-&gt;vertex_data = aj_list-&gt;vertex-&gt;alloc_vertex_data();</span>
<span class="lineNum">     788 </span><span class="lineNoCov">          0 :             vertex-&gt;alloc_vertex_data = aj_list-&gt;vertex-&gt;alloc_vertex_data;</span>
<span class="lineNum">     789 </span>            :         }
<span class="lineNum">     790 </span>            :         /* copy the vertex data from the original vertex  to the new vertex */
<span class="lineNum">     791 </span><span class="lineNoCov">          0 :         if (NULL != aj_list-&gt;vertex-&gt;copy_vertex_data) {</span>
<span class="lineNum">     792 </span><span class="lineNoCov">          0 :             aj_list-&gt;vertex-&gt;copy_vertex_data(&amp;(vertex-&gt;vertex_data), aj_list-&gt;vertex-&gt;vertex_data);</span>
<span class="lineNum">     793 </span><span class="lineNoCov">          0 :             vertex-&gt;copy_vertex_data = aj_list-&gt;vertex-&gt;copy_vertex_data;</span>
<span class="lineNum">     794 </span>            :         }
<span class="lineNum">     795 </span>            :         /* copy all the fields of the original vertex to the new vertex. */
<span class="lineNum">     796 </span><span class="lineNoCov">          0 :         vertex-&gt;free_vertex_data = aj_list-&gt;vertex-&gt;free_vertex_data;</span>
<span class="lineNum">     797 </span><span class="lineNoCov">          0 :         vertex-&gt;print_vertex = aj_list-&gt;vertex-&gt;print_vertex;</span>
<span class="lineNum">     798 </span><span class="lineNoCov">          0 :         vertex-&gt;compare_vertex = aj_list-&gt;vertex-&gt;compare_vertex;</span>
<span class="lineNum">     799 </span><span class="lineNoCov">          0 :         vertex-&gt;in_graph = *dest;</span>
<span class="lineNum">     800 </span>            :         /* add the new vertex to the new graph */
<span class="lineNum">     801 </span><span class="lineNoCov">          0 :         opal_graph_add_vertex(*dest, vertex);</span>
<span class="lineNum">     802 </span>            :     }
<span class="lineNum">     803 </span>            :     /**
<span class="lineNum">     804 </span>            :      * Now, copy all the edges from the source graph
<span class="lineNum">     805 </span>            :      */
<span class="lineNum">     806 </span>            :     /* Run on all the adjscency lists in the graph */
<span class="lineNum">     807 </span><span class="lineNoCov">          0 :     for (aj_list_item = opal_list_get_first(src-&gt;adjacency_list);</span>
<span class="lineNum">     808 </span><span class="lineNoCov">          0 :          aj_list_item != opal_list_get_end(src-&gt;adjacency_list);</span>
<span class="lineNum">     809 </span><span class="lineNoCov">          0 :          aj_list_item  = opal_list_get_next(aj_list_item)) {</span>
<span class="lineNum">     810 </span><span class="lineNoCov">          0 :         aj_list = (opal_adjacency_list_t *) aj_list_item;</span>
<span class="lineNum">     811 </span>            :         /* for all the edges in the adjscency list */
<span class="lineNum">     812 </span><span class="lineNoCov">          0 :         for (edg_item = opal_list_get_first(aj_list-&gt;edges);</span>
<span class="lineNum">     813 </span><span class="lineNoCov">          0 :              edg_item != opal_list_get_end(aj_list-&gt;edges);</span>
<span class="lineNum">     814 </span><span class="lineNoCov">          0 :              edg_item = opal_list_get_next(edg_item)) {</span>
<span class="lineNum">     815 </span><span class="lineNoCov">          0 :             edge = (opal_graph_edge_t *)edg_item;</span>
<span class="lineNum">     816 </span>            :             /* construct new edge for the new graph */
<span class="lineNum">     817 </span><span class="lineNoCov">          0 :             new_edge = OBJ_NEW(opal_graph_edge_t);</span>
<span class="lineNum">     818 </span>            :             /* copy the edge weight from the original edge */
<span class="lineNum">     819 </span><span class="lineNoCov">          0 :             new_edge-&gt;weight = edge-&gt;weight;</span>
<span class="lineNum">     820 </span>            :             /* connect the new edge according to start and end associations to the vertices of the src graph */
<span class="lineNum">     821 </span><span class="lineNoCov">          0 :             new_edge-&gt;start = edge-&gt;start-&gt;sibling;</span>
<span class="lineNum">     822 </span><span class="lineNoCov">          0 :             new_edge-&gt;end = edge-&gt;end-&gt;sibling;</span>
<span class="lineNum">     823 </span>            :             /* add the new edge to the new graph */
<span class="lineNum">     824 </span><span class="lineNoCov">          0 :             opal_graph_add_edge(*dest, new_edge);</span>
<span class="lineNum">     825 </span>            :         }
<span class="lineNum">     826 </span>            :     }
<span class="lineNum">     827 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     828 </span>            : 
<span class="lineNum">     829 </span>            : /**
<span class="lineNum">     830 </span>            :  * This graph API prints a graph - mostly for debug uses.
<a name="831"><span class="lineNum">     831 </span>            :  * @param graph</a>
<span class="lineNum">     832 </span>            :  */
<span class="lineNum">     833 </span><span class="lineNoCov">          0 : void opal_graph_print(opal_graph_t *graph)</span>
<span class="lineNum">     834 </span>            : {
<span class="lineNum">     835 </span>            :     opal_adjacency_list_t *aj_list;
<span class="lineNum">     836 </span>            :     opal_list_item_t *aj_list_item;
<span class="lineNum">     837 </span>            :     opal_graph_edge_t *edge;
<span class="lineNum">     838 </span>            :     opal_list_item_t *edge_item;
<span class="lineNum">     839 </span>            :     char *tmp_str1, *tmp_str2;
<span class="lineNum">     840 </span>            :     bool need_free1, need_free2;
<span class="lineNum">     841 </span>            : 
<span class="lineNum">     842 </span>            :     /* print header */
<span class="lineNum">     843 </span><span class="lineNoCov">          0 :     opal_output(0, &quot;      Graph         &quot;);</span>
<span class="lineNum">     844 </span><span class="lineNoCov">          0 :     opal_output(0, &quot;====================&quot;);</span>
<span class="lineNum">     845 </span>            :     /* run on all the vertices of the graph */
<span class="lineNum">     846 </span><span class="lineNoCov">          0 :     for (aj_list_item = opal_list_get_first(graph-&gt;adjacency_list);</span>
<span class="lineNum">     847 </span><span class="lineNoCov">          0 :          aj_list_item != opal_list_get_end(graph-&gt;adjacency_list);</span>
<span class="lineNum">     848 </span><span class="lineNoCov">          0 :          aj_list_item  = opal_list_get_next(aj_list_item)) {</span>
<span class="lineNum">     849 </span><span class="lineNoCov">          0 :         aj_list = (opal_adjacency_list_t *) aj_list_item;</span>
<span class="lineNum">     850 </span>            :         /* print vertex data to temporary string*/
<span class="lineNum">     851 </span><span class="lineNoCov">          0 :         if (NULL != aj_list-&gt;vertex-&gt;print_vertex) {</span>
<span class="lineNum">     852 </span><span class="lineNoCov">          0 :             need_free1 = true;</span>
<span class="lineNum">     853 </span><span class="lineNoCov">          0 :             tmp_str1 = aj_list-&gt;vertex-&gt;print_vertex(aj_list-&gt;vertex-&gt;vertex_data);</span>
<span class="lineNum">     854 </span>            :         }
<span class="lineNum">     855 </span>            :         else {
<span class="lineNum">     856 </span><span class="lineNoCov">          0 :             need_free1 = false;</span>
<span class="lineNum">     857 </span><span class="lineNoCov">          0 :             tmp_str1 = &quot;&quot;;</span>
<span class="lineNum">     858 </span>            :         }
<span class="lineNum">     859 </span>            :         /* print vertex */
<span class="lineNum">     860 </span><span class="lineNoCov">          0 :         opal_output(0, &quot;V(%s) Connections:&quot;,tmp_str1);</span>
<span class="lineNum">     861 </span>            :         /* run on all the edges of the vertex */
<span class="lineNum">     862 </span><span class="lineNoCov">          0 :         for (edge_item = opal_list_get_first(aj_list-&gt;edges);</span>
<span class="lineNum">     863 </span><span class="lineNoCov">          0 :              edge_item != opal_list_get_end(aj_list-&gt;edges);</span>
<span class="lineNum">     864 </span><span class="lineNoCov">          0 :              edge_item  = opal_list_get_next(edge_item)) {</span>
<span class="lineNum">     865 </span><span class="lineNoCov">          0 :             edge = (opal_graph_edge_t *)edge_item;</span>
<span class="lineNum">     866 </span>            :             /* print the vertex data of the vertex in the end of the edge to a temporary string */
<span class="lineNum">     867 </span><span class="lineNoCov">          0 :             if (NULL != edge-&gt;end-&gt;print_vertex) {</span>
<span class="lineNum">     868 </span><span class="lineNoCov">          0 :                 need_free2 = true;</span>
<span class="lineNum">     869 </span><span class="lineNoCov">          0 :                 tmp_str2 = edge-&gt;end-&gt;print_vertex(edge-&gt;end-&gt;vertex_data);</span>
<span class="lineNum">     870 </span>            :             }
<span class="lineNum">     871 </span>            :             else {
<span class="lineNum">     872 </span><span class="lineNoCov">          0 :                 need_free2 = false;</span>
<span class="lineNum">     873 </span><span class="lineNoCov">          0 :                 tmp_str2 = &quot;&quot;;</span>
<span class="lineNum">     874 </span>            :             }
<span class="lineNum">     875 </span>            :             /* print the edge */
<span class="lineNum">     876 </span><span class="lineNoCov">          0 :             opal_output(0, &quot;    E(%s -&gt; %d -&gt; %s)&quot;,tmp_str1, edge-&gt;weight, tmp_str2);</span>
<span class="lineNum">     877 </span><span class="lineNoCov">          0 :             if (need_free2) {</span>
<span class="lineNum">     878 </span><span class="lineNoCov">          0 :                 free(tmp_str2);</span>
<span class="lineNum">     879 </span>            :             }
<span class="lineNum">     880 </span>            :         }
<span class="lineNum">     881 </span><span class="lineNoCov">          0 :         if (need_free1) {</span>
<span class="lineNum">     882 </span><span class="lineNoCov">          0 :             free(tmp_str1);</span>
<span class="lineNum">     883 </span>            :         }
<span class="lineNum">     884 </span>            :     }
<span class="lineNum">     885 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     886 </span>            : 
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.11</a></td></tr>
  </table>
  <br>

</body>
</html>
